<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>ã‚³ãƒ³ãƒ“ãƒ‹ã‚¢ã‚¤ã‚¹è©•ä¾¡</title>
  <script src="js/jquery-2.1.3.min.js"></script>
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

   <!-- ãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ã™ã‚‹ãŸã‚ã®CSSã‚’è¿½åŠ  -->
  <style>
    body {
      font-family: 'M PLUS 1p', sans-serif;
    }
  </style>
  
</head>

<div class="bg-green-100 min-h-[100vh] p-20">

  <div class="flex items-start gap-20">
    <section class="w-1/3 bg-white rounded-md  p-10">
      <div id="ice-form" class="flex flex-col justify-center gap-4">
        <h2 class="text-xl font-semibold">ğŸ¨ é£Ÿã¹ãŸã‚¢ã‚¤ã‚¹ã‚’è¨˜éŒ²ã™ã‚‹</h2>
        <div>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">ã‚¢ã‚¤ã‚¹ã®åå‰</label>
          <input type="text" placeholder="ã‚¢ã‚¤ã‚¹ã®åå‰" id="ice-name"
            class="p-3 rounded-md block bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
        </div>
        <div>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">é£Ÿã¹ãŸæ—¥</label>
          <input type="date" placeholder="è³¼å…¥æ—¥" id="ice-date"
            class="p-3 rounded-md block bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
        </div>
        <div>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">è³¼å…¥ã—ãŸã‚³ãƒ³ãƒ“ãƒ‹</label>
          <input type="text" placeholder="è³¼å…¥ã—ãŸã‚³ãƒ³ãƒ“ãƒ‹" id="ice-store"
            class="p-3 rounded-md block bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
        </div>
        <div>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">ãŠå€¤æ®µ</label>
          <input type="text" placeholder="250å††" id="ice-price"
            class="p-3 rounded-md block bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
        </div>
        <div>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white mt-4">5æ®µéšè©•ä¾¡</label>
          <input type="range"  placeholder="1~5ã§è©•ä¾¡" id="ice-rating" min="1" max="5"
          class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">
        </div>
        <div>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900">
            <input type="file" name="example" accept="image/jpeg, image/png" id="ice-photo" onchange="previewImage(this)" class="p-2 block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50">
          </label>
          <div id="preview-area" class="mt-2"> <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®è¦ç´ ã‚’è¿½åŠ  -->
            <img id="preview" style="max-width: 200px; display: none;">
          </div>
        <div class=mt-5>
          <label for="text" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">ãƒ¡ãƒ¢</label>
          <textarea placeholder="è‡ªç”±ã«ã‚³ãƒ¡ãƒ³ãƒˆ" id="text"
          class="p-3 rounded-md block bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"></textarea>
        </div>
      </div>

      <div class="button-area gap-6 mt-8">
        <button id="save" class="bg-blue-700 p-3 rounded-md text-white hover:opacity-50">è¨˜éŒ²ã™ã‚‹</button>
        <button id="clear" class="bg-white p-3 rounded-md ml-3 border border-blue-700 text-blue-700 hover:opacity-50">ã‚¯ãƒªã‚¢</button>
      </div>
         
    </section>
    
    <section class="flex-1 bg-white p-10 rounded-md">
      <h2 class="text-xl font-semibold mb-5">âœ… ã“ã‚Œã¾ã§è¨˜éŒ²ã—ãŸã‚¢ã‚¤ã‚¹</h2>
      <ul id="ice-list">
        <!-- ã“ã“ã«è¿½åŠ ãƒ‡ãƒ¼ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
      </ul>
    </section>

</div>
  
  <!-- ä»¥ä¸‹ã«jsã‚’æ›¸ã„ã¦ã„ãã¾ã™ -->
  <script>

   // ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®é–¢æ•°
        function previewImage(input) {
          const preview = document.getElementById('preview');
          preview.style.display = 'none';

          if (input.files && input.files[0]) {
            const reader = new FileReader();

            reader.onload = function (e) {
              preview.src = e.target.result;
              preview.style.display = 'block';
            };

            reader.readAsDataURL(input.files[0]);
          }
        }


  const iceForm = document.getElementById("ice-form");
  const iceList = document.getElementById("ice-list");
  const iceData = JSON.parse(localStorage.getItem("iceRecords")) || [];

    //1.Save ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    $("#save").on("click" , function(){
      const key = $("#ice-name").val(); //ã‚¢ã‚¤ã‚¹ã®åå‰ã‚’ã‚­ãƒ¼ã¨ã—ã¦ä¿å­˜
      const iceData = {
        date: $("#ice-date").val(),
        store: $("#ice-store").val(),
        price: $("#ice-price").val(),
        rating: $("#ice-rating").val(),
        photo: preview.src, // Base64ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
        comments: $("#text").val(),
      };

      //ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
      localStorage.setItem(key, JSON.stringify(iceData));

       // ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ã«htmlã¨ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’çµ„ã¿åˆã‚ã›ã‚‹
      const html = `
      <li class="mb-5 bg-yellow-50 p-4 rounded-md gap-2">
        <h3 class="font-bold mb-2">${key}</h3>
        <p>${key}</p>
        <p>æ—¥ä»˜: ${iceData.date}</p>
        <p>åº—èˆ—: ${iceData.store}</p>
        <p>ä¾¡æ ¼: ${iceData.price}å††</p>
        <p>è©•ä¾¡: ${iceData.rating}/5</p>
        ${iceData.photo ? `<img src="${iceData.photo}" class="mt-2 mb-2 max-w-[200px]">` : ''}
        <p>ã‚³ãƒ¡ãƒ³ãƒˆ: ${iceData.comments}</p>
      </li>
    `;

    // jQueryã®ãŠã¾ã˜ãªã„ã€€ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ï¼ˆhtmlã‚’è¿½åŠ ã™ã‚‹ï¼‰
      $("#ice-list").append(html);

    });


    //2.clear ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      $("#clear").on("click", function () {
        localStorage.clear();
        $("#ice-list").empty();
        document.getElementById('preview').style.display = 'none';
        document.getElementById('ice-form').reset();
      });


    //3.ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ï¼šä¿å­˜ãƒ‡ãƒ¼ã‚¿å–å¾—è¡¨ç¤º
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        try {
          const data = JSON.parse(localStorage.getItem(key));
          const html = `
          <li class="mb-5 bg-yellow-50 p-4 rounded-md gap-2">
            <h3 class="font-bold mb-2">${key}</h3>
            <p>æ—¥ä»˜: ${data.date}</p>
            <p>åº—èˆ—: ${data.store}</p>
            <p>ä¾¡æ ¼: ${data.price}å††</p>
            <p>è©•ä¾¡: ${data.rating}/5</p>
            ${data.photo ? `<img src="${data.photo}" class="mt-2 mb-2 max-w-[200px]">` : ''}
            <p>ã‚³ãƒ¡ãƒ³ãƒˆ: ${data.comments}</p>
          </li>
        `;
          $("#ice-list").append(html);
        } catch (e) {
          console.error('ãƒ‡ãƒ¼ã‚¿ã®è§£æã«å¤±æ•—ã—ã¾ã—ãŸ:', e);
        }
      }

     document.getElementById('ice-date').valueAsDate = new Date();

  </script>
</body>

</html>